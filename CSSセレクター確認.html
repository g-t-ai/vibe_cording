<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Çª„É¨„ÇØ„Çø„ÉºËß£Êûê„ÉÑ„Éº„É´ - PADÁî®</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .panel h2 {
            margin-top: 0;
            color: #444;
            font-size: 18px;
            border-bottom: 2px solid #007acc;
            padding-bottom: 10px;
        }
        
        textarea {
            width: 100%;
            min-height: 300px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            resize: vertical;
        }
        
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #005a9e;
        }
        
        #preview {
            min-height: 300px;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: #fafafa;
            overflow: auto;
        }
        
        #preview * {
            cursor: pointer;
            transition: all 0.2s;
        }
        
        #preview *:hover {
            outline: 2px solid #007acc;
            background-color: rgba(0, 122, 204, 0.1);
        }
        
        .selected {
            outline: 3px solid #ff6b6b !important;
            background-color: rgba(255, 107, 107, 0.1) !important;
        }
        
        .selector-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .selector-item {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f8f8f8;
            border-radius: 4px;
            border-left: 4px solid #007acc;
        }
        
        .selector-label {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
            display: block;
        }
        
        .selector-value {
            font-family: 'Consolas', 'Monaco', monospace;
            background-color: #e8e8e8;
            padding: 8px;
            border-radius: 4px;
            margin-top: 5px;
            word-break: break-all;
            position: relative;
        }
        
        .copy-button {
            position: absolute;
            right: 5px;
            top: 5px;
            padding: 5px 10px;
            font-size: 12px;
            background-color: #28a745;
        }
        
        .copy-button:hover {
            background-color: #218838;
        }
        
        .attributes-list {
            margin-top: 10px;
        }
        
        .attribute-item {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            background-color: white;
            margin-bottom: 5px;
            border-radius: 3px;
        }
        
        .attribute-name {
            font-weight: bold;
            color: #007acc;
        }
        
        .attribute-value {
            color: #666;
            font-family: monospace;
        }
        
        .xpath-options {
            margin-top: 10px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 4px;
        }
        
        .checkbox-group {
            margin: 5px 0;
        }
        
        .checkbox-group label {
            margin-left: 5px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç „Çª„É¨„ÇØ„Çø„ÉºËß£Êûê„ÉÑ„Éº„É´ for Power Automate Desktop</h1>
        
        <div class="main-grid">
            <div class="panel">
                <h2>HTML„Ç≥„Éº„ÉâÂÖ•Âäõ</h2>
                <textarea id="htmlInput" placeholder="„Åì„Åì„Å´HTML„Ç≥„Éº„Éâ„ÇíË≤º„Çä‰ªò„Åë„Å¶„Åè„Å†„Åï„ÅÑ...">
<div class="container">
    <header id="main-header">
        <h1 class="title">„Çµ„É≥„Éó„É´„Éö„Éº„Ç∏</h1>
        <nav>
            <ul class="nav-list">
                <li><a href="#" data-id="home">„Éõ„Éº„É†</a></li>
                <li><a href="#" data-id="about">Ê¶ÇË¶Å</a></li>
                <li><a href="#" data-id="contact">„ÅäÂïè„ÅÑÂêà„Çè„Åõ</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section class="content" data-section="main">
            <h2>„É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ</h2>
            <p>„Åì„Çå„ÅØ„Çµ„É≥„Éó„É´„ÉÜ„Ç≠„Çπ„Éà„Åß„Åô„ÄÇ</p>
            <button id="submit-btn" class="btn btn-primary" type="button">ÈÄÅ‰ø°</button>
            <input type="text" id="username" name="username" placeholder="„É¶„Éº„Ç∂„ÉºÂêç">
        </section>
    </main>
</div>
                </textarea>
                <button onclick="parseHTML()">HTML„ÇíËß£Êûê</button>
            </div>
            
            <div class="panel">
                <h2>„Éó„É¨„Éì„É•„ÉºÔºà„ÇØ„É™„ÉÉ„ÇØ„ÅßË¶ÅÁ¥†„ÇíÈÅ∏ÊäûÔºâ</h2>
                <div id="preview"></div>
            </div>
        </div>
        
        <div class="selector-info" id="selectorInfo" style="display: none;">
            <h2>ÈÅ∏Êäû„Åó„ÅüË¶ÅÁ¥†„ÅÆÊÉÖÂ†±</h2>
            
            <div class="selector-item">
                <span class="selector-label">Ë¶ÅÁ¥†„Çø„Ç§„Éó:</span>
                <div class="selector-value" id="elementType"></div>
            </div>
            
            <div class="selector-item">
                <span class="selector-label">CSS „Çª„É¨„ÇØ„Çø„Éº:</span>
                <div class="selector-value" id="cssSelector">
                    <span id="cssSelectorText"></span>
                    <button class="copy-button" onclick="copyToClipboard('cssSelectorText')">„Ç≥„Éî„Éº</button>
                </div>
            </div>
            
            <div class="selector-item">
                <span class="selector-label">XPath:</span>
                <div class="xpath-options">
                    <div class="checkbox-group">
                        <input type="checkbox" id="useId" checked onchange="updateXPath()">
                        <label for="useId">IDÂ±ûÊÄß„Çí‰ΩøÁî®</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="useClass" onchange="updateXPath()">
                        <label for="useClass">ClassÂ±ûÊÄß„Çí‰ΩøÁî®</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="usePosition" onchange="updateXPath()">
                        <label for="usePosition">‰ΩçÁΩÆÊÉÖÂ†±„Çí‰ΩøÁî®</label>
                    </div>
                </div>
                <div class="selector-value" id="xpathSelector">
                    <span id="xpathSelectorText"></span>
                    <button class="copy-button" onclick="copyToClipboard('xpathSelectorText')">„Ç≥„Éî„Éº</button>
                </div>
            </div>
            
            <div class="selector-item">
                <span class="selector-label">ID:</span>
                <div class="selector-value" id="elementId">
                    <span id="elementIdText"></span>
                    <button class="copy-button" onclick="copyToClipboard('elementIdText')">„Ç≥„Éî„Éº</button>
                </div>
            </div>
            
            <div class="selector-item">
                <span class="selector-label">„ÇØ„É©„Çπ:</span>
                <div class="selector-value" id="elementClasses">
                    <span id="elementClassesText"></span>
                    <button class="copy-button" onclick="copyToClipboard('elementClassesText')">„Ç≥„Éî„Éº</button>
                </div>
            </div>
            
            <div class="selector-item">
                <span class="selector-label">Â±ûÊÄß‰∏ÄË¶ß:</span>
                <div class="attributes-list" id="attributesList"></div>
            </div>
            
            <div class="selector-item">
                <span class="selector-label">PADÁî®„ÅÆÊé®Â•®„Çª„É¨„ÇØ„Çø„Éº:</span>
                <div class="selector-value" id="padSelector">
                    <span id="padSelectorText"></span>
                    <button class="copy-button" onclick="copyToClipboard('padSelectorText')">„Ç≥„Éî„Éº</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">„Ç≥„Éî„Éº„Åó„Åæ„Åó„ÅüÔºÅ</div>
    
    <script>
        let selectedElement = null;
        let parsedDocument = null;
        
        function parseHTML() {
            const htmlInput = document.getElementById('htmlInput').value;
            const preview = document.getElementById('preview');
            
            // HTML„Çí„Éë„Éº„Çπ
            const parser = new DOMParser();
            parsedDocument = parser.parseFromString(htmlInput, 'text/html');
            
            // „Éó„É¨„Éì„É•„Éº„Å´Ë°®Á§∫
            preview.innerHTML = parsedDocument.body.innerHTML;
            
            // „ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„ÇíËøΩÂä†
            preview.querySelectorAll('*').forEach(element => {
                element.addEventListener('click', function(e) {
                    e.stopPropagation();
                    selectElement(this);
                });
            });
        }
        
        function selectElement(element) {
            // Ââç„ÅÆÈÅ∏Êäû„ÇíËß£Èô§
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }
            
            // Êñ∞„Åó„ÅÑË¶ÅÁ¥†„ÇíÈÅ∏Êäû
            selectedElement = element;
            element.classList.add('selected');
            
            // „Çª„É¨„ÇØ„Çø„ÉºÊÉÖÂ†±„ÇíË°®Á§∫
            displaySelectorInfo(element);
        }
        
        function displaySelectorInfo(element) {
            document.getElementById('selectorInfo').style.display = 'block';
            
            // Ë¶ÅÁ¥†„Çø„Ç§„Éó
            document.getElementById('elementType').textContent = element.tagName.toLowerCase();
            
            // CSS „Çª„É¨„ÇØ„Çø„Éº
            const cssSelector = generateCSSSelector(element);
            document.getElementById('cssSelectorText').textContent = cssSelector;
            
            // XPath
            updateXPath();
            
            // ID
            document.getElementById('elementIdText').textContent = element.id || '(„Å™„Åó)';
            
            // „ÇØ„É©„Çπ
            document.getElementById('elementClassesText').textContent = 
                element.className ? `.${element.className.split(' ').join('.')}` : '(„Å™„Åó)';
            
            // Â±ûÊÄß‰∏ÄË¶ß
            displayAttributes(element);
            
            // PADÁî®Êé®Â•®„Çª„É¨„ÇØ„Çø„Éº
            const padSelector = generatePADSelector(element);
            document.getElementById('padSelectorText').textContent = padSelector;
        }
        
        function generateCSSSelector(element) {
            const path = [];
            
            while (element && element.nodeType === Node.ELEMENT_NODE) {
                let selector = element.tagName.toLowerCase();
                
                if (element.id) {
                    selector = '#' + element.id;
                    path.unshift(selector);
                    break;
                } else if (element.className) {
                    selector += '.' + element.className.split(' ').filter(c => c).join('.');
                }
                
                path.unshift(selector);
                element = element.parentElement;
            }
            
            return path.join(' > ');
        }
        
        function generateXPath(element, useId, useClass, usePosition) {
            const path = [];
            
            while (element && element.nodeType === Node.ELEMENT_NODE) {
                let xpath = element.tagName.toLowerCase();
                
                if (useId && element.id) {
                    xpath = `//${xpath}[@id="${element.id}"]`;
                    path.unshift(xpath);
                    break;
                } else {
                    const conditions = [];
                    
                    if (useClass && element.className) {
                        conditions.push(`@class="${element.className}"`);
                    }
                    
                    // ‰ªñ„ÅÆÂ±ûÊÄß„ÇíËøΩÂä†
                    if (element.hasAttribute('name')) {
                        conditions.push(`@name="${element.getAttribute('name')}"`);
                    }
                    if (element.hasAttribute('type')) {
                        conditions.push(`@type="${element.getAttribute('type')}"`);
                    }
                    
                    if (conditions.length > 0) {
                        xpath += `[${conditions.join(' and ')}]`;
                    } else if (usePosition) {
                        // ‰ΩçÁΩÆÊÉÖÂ†±„ÇíËøΩÂä†
                        const siblings = Array.from(element.parentNode?.children || []);
                        const sameTagSiblings = siblings.filter(s => s.tagName === element.tagName);
                        if (sameTagSiblings.length > 1) {
                            const position = sameTagSiblings.indexOf(element) + 1;
                            xpath += `[${position}]`;
                        }
                    }
                }
                
                path.unshift(xpath);
                element = element.parentElement;
            }
            
            return '//' + path.join('/');
        }
        
        function updateXPath() {
            if (!selectedElement) return;
            
            const useId = document.getElementById('useId').checked;
            const useClass = document.getElementById('useClass').checked;
            const usePosition = document.getElementById('usePosition').checked;
            
            const xpath = generateXPath(selectedElement, useId, useClass, usePosition);
            document.getElementById('xpathSelectorText').textContent = xpath;
        }
        
        function displayAttributes(element) {
            const attributesList = document.getElementById('attributesList');
            attributesList.innerHTML = '';
            
            const attributes = element.attributes;
            if (attributes.length === 0) {
                attributesList.innerHTML = '<div style="color: #666;">Â±ûÊÄß„Å™„Åó</div>';
                return;
            }
            
            for (let i = 0; i < attributes.length; i++) {
                const attr = attributes[i];
                const attrItem = document.createElement('div');
                attrItem.className = 'attribute-item';
                attrItem.innerHTML = `
                    <span class="attribute-name">${attr.name}:</span>
                    <span class="attribute-value">${attr.value}</span>
                `;
                attributesList.appendChild(attrItem);
            }
        }
        
        function generatePADSelector(element) {
            // Power Automate DesktopÁî®„ÅÆÊúÄÈÅ©„Å™„Çª„É¨„ÇØ„Çø„Éº„ÇíÁîüÊàê
            
            // 1. ID„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØÊúÄÂÑ™ÂÖà
            if (element.id) {
                return `id="${element.id}"`;
            }
            
            // 2. nameÂ±ûÊÄß„Åå„ÅÇ„ÇãÂ†¥ÂêàÔºà„Éï„Ç©„Éº„É†Ë¶ÅÁ¥†„Åß„Çà„Åè‰ΩøÁî®Ôºâ
            if (element.hasAttribute('name')) {
                return `name="${element.getAttribute('name')}"`;
            }
            
            // 3. dataÂ±ûÊÄß„Åå„ÅÇ„ÇãÂ†¥Âêà
            const dataAttributes = Array.from(element.attributes)
                .filter(attr => attr.name.startsWith('data-'));
            if (dataAttributes.length > 0) {
                const dataAttr = dataAttributes[0];
                return `${dataAttr.name}="${dataAttr.value}"`;
            }
            
            // 4. ‰∏ÄÊÑè„ÅÆ„ÇØ„É©„Çπ„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ
            if (element.className) {
                const classes = element.className.split(' ').filter(c => c);
                if (classes.length > 0) {
                    // Âêå„Åò„ÇØ„É©„Çπ„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ„ÇíÊåÅ„Å§Ë¶ÅÁ¥†„Åå‰ªñ„Å´„Å™„ÅÑ„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                    const selector = '.' + classes.join('.');
                    const similar = document.querySelectorAll(selector);
                    if (similar.length === 1) {
                        return `class="${element.className}"`;
                    }
                }
            }
            
            // 5. „Çø„Ç∞Âêç„Å®‰ΩçÁΩÆ„ÅÆÁµÑ„ÅøÂêà„Çè„Åõ
            const parent = element.parentElement;
            if (parent) {
                const siblings = Array.from(parent.children);
                const sameTagSiblings = siblings.filter(s => s.tagName === element.tagName);
                const position = sameTagSiblings.indexOf(element) + 1;
                
                if (parent.id) {
                    return `${element.tagName.toLowerCase()}:nth-of-type(${position}) (Ë¶™Ë¶ÅÁ¥†: #${parent.id})`;
                } else {
                    return `${element.tagName.toLowerCase()}:nth-of-type(${position})`;
                }
            }
            
            // 6. „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
            return generateCSSSelector(element);
        }
        
        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            
            // „ÉÜ„Ç≠„Çπ„Éà„Ç®„É™„Ç¢„Çí‰ΩúÊàê„Åó„Å¶„Ç≥„Éî„Éº
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            
            // ÈÄöÁü•„ÇíË°®Á§∫
            showNotification();
        }
        
        function showNotification() {
            const notification = document.getElementById('notification');
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }
        
        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´„Çµ„É≥„Éó„É´HTML„ÇíËß£Êûê
        window.onload = function() {
            parseHTML();
        };
        
        // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
        document.addEventListener('keydown', function(e) {
            // Esc„Ç≠„Éº„ÅßÈÅ∏ÊäûËß£Èô§
            if (e.key === 'Escape' && selectedElement) {
                selectedElement.classList.remove('selected');
                selectedElement = null;
                document.getElementById('selectorInfo').style.display = 'none';
            }
        });
        
        // ËøΩÂä†„ÅÆ‰æøÂà©Ê©üËÉΩÔºöË¶ÅÁ¥†„ÅÆ„Éè„Ç§„É©„Ç§„ÉàË°®Á§∫
        function highlightElement(selector) {
            try {
                const elements = document.querySelectorAll(selector);
                elements.forEach(el => {
                    el.style.outline = '3px solid #ff6b6b';
                    setTimeout(() => {
                        el.style.outline = '';
                    }, 2000);
                });
            } catch (e) {
                console.error('ÁÑ°Âäπ„Å™„Çª„É¨„ÇØ„Çø„Éº:', e);
            }
        }
        
        // „Çª„É¨„ÇØ„Çø„Éº„ÅÆ„ÉÜ„Çπ„ÉàÊ©üËÉΩ
        function testSelector() {
            const selector = prompt('„ÉÜ„Çπ„Éà„Åô„Çã„Çª„É¨„ÇØ„Çø„Éº„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:');
            if (selector) {
                try {
                    const elements = document.querySelectorAll(selector);
                    alert(`${elements.length}ÂÄã„ÅÆË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åó„Åü`);
                    highlightElement(selector);
                } catch (e) {
                    alert('ÁÑ°Âäπ„Å™„Çª„É¨„ÇØ„Çø„Éº„Åß„Åô: ' + e.message);
                }
            }
        }
    </script>
</body>
</html>